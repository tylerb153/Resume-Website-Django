
document.addEventListener('DOMContentLoaded', getStatus())


function getStatus() {
    const launchURL = "https://ll.thespacedevs.com/2.3.0/launches/upcoming/?limit=1&format=json"
    const eventURL = "https://ll.thespacedevs.com/2.3.0/events/upcoming/?limit=1&format=json"
    
    // const launchData = JSON.parse(`{"count":329,"next":"https://ll.thespacedevs.com/2.3.0/launches/upcoming/?format=json&limit=1&offset=1","previous":null,"results":[{"id":"594ae0c5-2039-4a1a-a6be-7b0940b2ed2c","url":"https://ll.thespacedevs.com/2.3.0/launches/594ae0c5-2039-4a1a-a6be-7b0940b2ed2c/?format=json","name":"Falcon 9 Block 5 | Project Kuiper (KF-02)","response_mode":"normal","slug":"falcon-9-block-5-project-kuiper-kf-02","launch_designator":null,"status":{"id":1,"name":"Go for Launch","abbrev":"Go","description":"Current T-0 confirmed by official or reliable sources."},"last_updated":"2025-08-09T17:44:18Z","net":"2025-08-10T12:57:00Z","net_precision":{"id":1,"name":"Minute","abbrev":"MIN","description":"The T-0 is accurate to the minute."},"window_end":"2025-08-10T13:24:00Z","window_start":"2025-08-10T12:57:00Z","image":{"id":2434,"name":"F9 on SLC-40 (KF-02)","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/f9_on_slc-40_2_image_20250807141208.jpeg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/f9_on_slc-40_2_image_thumbnail_20250807141210.jpeg","credit":"SpaceX","license":{"id":1,"name":"Unknown","priority":9,"link":null},"single_use":true,"variants":[]},"infographic":null,"probability":55,"weather_concerns":"Cumulus Cloud Rule, Anvil Rules, Lightning Rule","failreason":"","hashtag":null,"launch_service_provider":{"response_mode":"list","id":121,"url":"https://ll.thespacedevs.com/2.3.0/agencies/121/?format=json","name":"SpaceX","abbrev":"SpX","type":{"id":3,"name":"Commercial"}},"rocket":{"id":8112,"configuration":{"response_mode":"list","id":164,"url":"https://ll.thespacedevs.com/2.3.0/launcher_configurations/164/?format=json","name":"Falcon 9","families":[{"response_mode":"list","id":1,"name":"Falcon"},{"response_mode":"list","id":176,"name":"Falcon 9"}],"full_name":"Falcon 9 Block 5","variant":"Block 5"}},"mission":{"id":6670,"name":"Project Kuiper (KF-02)","type":"Communications","description":"Second of a three launches contract for Amazon's Kuiper low Earth orbit satellite internet constellation. 24 satellites are on board.","image":null,"orbit":{"id":8,"name":"Low Earth Orbit","abbrev":"LEO","celestial_body":{"response_mode":"list","id":1,"name":"Earth"}},"agencies":[{"response_mode":"normal","id":1058,"url":"https://ll.thespacedevs.com/2.3.0/agencies/1058/?format=json","name":"Kuiper Systems LLC","abbrev":"Amazon","type":{"id":5,"name":"Private"},"featured":false,"country":[{"id":2,"name":"United States of America","alpha_2_code":"US","alpha_3_code":"USA","nationality_name":"American","nationality_name_composed":"Americano"}],"description":"Kuiper Systems LLC, also known as Project Kuiper, is a subsidiary of Amazon that was established in 2019 to deploy a large satellite internet constellation to provide low-latency broadband internet connectivity.","administrator":"President: Rajeev Badyal","founding_year":2019,"launchers":"","spacecraft":"","parent":null,"image":null,"logo":null,"social_logo":null,"total_launch_count":0,"consecutive_successful_launches":0,"successful_launches":0,"failed_launches":0,"pending_launches":0,"consecutive_successful_landings":0,"successful_landings":0,"failed_landings":0,"attempted_landings":0,"successful_landings_spacecraft":0,"failed_landings_spacecraft":0,"attempted_landings_spacecraft":0,"successful_landings_payload":0,"failed_landings_payload":0,"attempted_landings_payload":0,"info_url":null,"wiki_url":"https://en.wikipedia.org/wiki/Kuiper_Systems","social_media_links":[]}],"info_urls":[],"vid_urls":[]},"pad":{"id":80,"url":"https://ll.thespacedevs.com/2.3.0/pads/80/?format=json","active":true,"agencies":[{"response_mode":"normal","id":121,"url":"https://ll.thespacedevs.com/2.3.0/agencies/121/?format=json","name":"SpaceX","abbrev":"SpX","type":{"id":3,"name":"Commercial"},"featured":true,"country":[{"id":2,"name":"United States of America","alpha_2_code":"US","alpha_3_code":"USA","nationality_name":"American","nationality_name_composed":"Americano"}],"description":"Space Exploration Technologies Corp., known as SpaceX, is an American aerospace manufacturer and space transport services company headquartered in Hawthorne, California. It was founded in 2002 by entrepreneur Elon Musk with the goal of reducing space transportation costs and enabling the colonization of Mars. SpaceX operates from many pads, on the East Coast of the US they operate from SLC-40 at Cape Canaveral Space Force Station and historic LC-39A at Kennedy Space Center. They also operate from SLC-4E at Vandenberg Space Force Base, California, usually for polar launches. Another launch site is being developed at Boca Chica, Texas.","administrator":"CEO: Elon Musk","founding_year":2002,"launchers":"Falcon | Starship","spacecraft":"Dragon","parent":null,"image":{"id":29,"name":"[AUTO] SpaceX - image","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/spacex_image_20190207032501.jpeg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/255bauto255d__image_thumbnail_20240305184704.jpeg","credit":null,"license":{"id":1,"name":"Unknown","priority":9,"link":null},"single_use":true,"variants":[]},"logo":{"id":186,"name":"[AUTO] SpaceX - logo","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/spacex_logo_20220826094919.png","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/255bauto255d__image_thumbnail_20240305185138.png","credit":null,"license":{"id":1,"name":"Unknown","priority":9,"link":null},"single_use":true,"variants":[]},"social_logo":{"id":94,"name":"[AUTO] SpaceX - social_logo","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/spacex_nation_20230531064544.jpg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/255bauto255d__image_thumbnail_20240305184848.jpeg","credit":null,"license":{"id":1,"name":"Unknown","priority":9,"link":null},"single_use":true,"variants":[]}}],"name":"Space Launch Complex 40","image":{"id":2113,"name":"F9 liftoff from SLC-40 (SES-24)","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/f9_liftoff_from_image_20240621050513.jpeg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/f9_liftoff_from_image_thumbnail_20240621050514.jpeg","credit":"SpaceX","license":{"id":5,"name":"CC BY-NC 2.0","priority":1,"link":"https://creativecommons.org/licenses/by-nc/2.0/"},"single_use":false,"variants":[]},"description":"","info_url":null,"wiki_url":"https://en.wikipedia.org/wiki/Cape_Canaveral_Air_Force_Station_Space_Launch_Complex_40","map_url":"https://www.google.com/maps?q=28.56194122,-80.57735736","latitude":28.56194122,"longitude":-80.57735736,"country":{"id":2,"name":"United States of America","alpha_2_code":"US","alpha_3_code":"USA","nationality_name":"American","nationality_name_composed":"Americano"},"map_image":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/map_images/pad_80_20200803143323.jpg","total_launch_count":326,"orbital_launch_attempt_count":326,"fastest_turnaround":"P2DT8H31M10S","location":{"response_mode":"normal","id":12,"url":"https://ll.thespacedevs.com/2.3.0/locations/12/?format=json","name":"Cape Canaveral SFS, FL, USA","celestial_body":{"response_mode":"normal","id":1,"name":"Earth","type":{"id":1,"name":"Planet"},"diameter":12742000.0,"mass":5.972168e+24,"gravity":9.80655,"length_of_day":"1 00:00:00","atmosphere":true,"image":{"id":2040,"name":"Earth (Apollo 17)","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/earth_2528apol_image_20240402194304.jpeg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/earth_2528apol_image_thumbnail_20240402194305.jpeg","credit":"NASA","license":{"id":4,"name":"NASA Image and Media Guidelines","priority":0,"link":"https://www.nasa.gov/nasa-brand-center/images-and-media/"},"single_use":true,"variants":[]},"description":"Earth is the third planet from the Sun and the only astronomical object known to harbor life.","wiki_url":"https://en.wikipedia.org/wiki/Earth","total_attempted_launches":7233,"successful_launches":6687,"failed_launches":546,"total_attempted_landings":1159,"successful_landings":1114,"failed_landings":45},"active":true,"country":{"id":2,"name":"United States of America","alpha_2_code":"US","alpha_3_code":"USA","nationality_name":"American","nationality_name_composed":"Americano"},"description":"Cape Canaveral Space Force Station (CCSFS) is an installation of the United States Space Force's Space Launch Delta 45, located on Cape Canaveral in Brevard County, Florida.","image":{"id":2200,"name":"Cape Canaveral & KSC seen from orbit (STS-43)","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/cape_canaveral__image_20240918151615.jpg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/cape_canaveral__image_thumbnail_20240918151616.jpeg","credit":"NASA","license":{"id":4,"name":"NASA Image and Media Guidelines","priority":0,"link":"https://www.nasa.gov/nasa-brand-center/images-and-media/"},"single_use":true,"variants":[]},"map_image":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/map_images/location_12_20200803142519.jpg","longitude":-80.577778,"latitude":28.488889,"timezone_name":"America/New_York","total_launch_count":1043,"total_landing_count":66}},"webcast_live":false,"program":[{"response_mode":"normal","id":27,"url":"https://ll.thespacedevs.com/2.3.0/programs/27/?format=json","name":"Project Kuiper","image":{"id":1898,"name":"Amazon Kuiper dish","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/project2520kui_program_20231228165031.jpeg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/255bauto255d__image_thumbnail_20240305194059.jpeg","credit":"Amazon","license":{"id":1,"name":"Unknown","priority":9,"link":null},"single_use":true,"variants":[]},"info_url":"https://en.wikipedia.org/wiki/Kuiper_Systems","wiki_url":"http://aboutamazon.com/what-we-do/devices-services/project-kuiper","description":"Amazon's Kuiper Project is a satellite internet initiative aimed at providing high-speed, low-latency broadband connectivity to underserved and remote areas globally. The project involves deploying a constellation of low Earth orbit (LEO) satellites to create a satellite internet network capable of delivering reliable internet access.","agencies":[{"response_mode":"list","id":1058,"url":"https://ll.thespacedevs.com/2.3.0/agencies/1058/?format=json","name":"Kuiper Systems LLC","abbrev":"Amazon","type":{"id":5,"name":"Private"}}],"start_date":"2023-10-16T18:06:00Z","end_date":null,"mission_patches":[],"type":{"id":3,"name":"Communication Constellation"}}],"orbital_launch_attempt_count":7025,"location_launch_attempt_count":1044,"pad_launch_attempt_count":327,"agency_launch_attempt_count":549,"orbital_launch_attempt_count_year":176,"location_launch_attempt_count_year":50,"pad_launch_attempt_count_year":47,"agency_launch_attempt_count_year":100}]}`)
    // const eventData = JSON.parse(`{"count":23,"next":"https://ll.thespacedevs.com/2.3.0/events/upcoming/?format=json&limit=1&offset=1","previous":null,"results":[{"id":1016,"url":"https://ll.thespacedevs.com/2.3.0/events/1016/?format=json","name":"Juice Venus Flyby","info_urls":[{"priority":10,"source":"www.esa.int","title":"ESAâ€™s Juice lifts off on quest to discover secrets of Jupiterâ€™s icy moons","description":"ESAâ€™s Jupiter Icy Moons Explorer (Juice) lifted off on an Ariane 5 rocket from Europeâ€™s Spaceport in French Guiana at 14:14 CEST on 14 April. The successful launch marks the beginning of an ambitious voyage to uncover the secrets of the ocean worlds around giant planet Jupiter.","feature_image":null,"url":"https://www.esa.int/Science_Exploration/Space_Science/Juice/ESA_s_Juice_lifts_off_on_quest_to_discover_secrets_of_Jupiter_s_icy_moons","type":{"id":1,"name":"Official Page"},"language":{"id":1,"name":"English","code":"en"}}],"vid_urls":[],"image":{"id":1035,"name":"JUICE render","image_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/255bauto255d__image_20240307192047.jpeg","thumbnail_url":"https://thespacedevs-prod.nyc3.digitaloceanspaces.com/media/images/255bauto255d__image_thumbnail_20240307192048.jpeg","credit":"spacecraft: ESA/ATG medialab; Jupiter: NASA/ESA/J. Nichols (University of Leicester); Ganymede: NASA/JPL; Io: NASA/JPL/University of Arizona; Callisto and Europa: NASA/JPL/DLR","license":{"id":2,"name":"ESA Standard Licence","priority":2,"link":"https://www.esa.int/ESA_Multimedia/Terms_and_conditions_of_use_of_images_and_videos_available_on_the_esa_website"},"single_use":false,"variants":[]},"date":"2025-08-31T00:00:00Z","slug":"juice-venus-flyby","type":{"id":23,"name":"Flyby"},"description":"Second flyby of ESA's Jupiter Icy Moons Explorer (Juice) mission on its way to the Jovian system.","webcast_live":false,"location":"Venus","date_precision":{"id":7,"name":"Month","abbrev":"M","description":"The T-0 is expected in the given month."},"response_mode":"normal","duration":null,"updates":[],"last_updated":"2024-07-15T09:33:06Z"}]}`)

    // window.dispatchEvent(new CustomEvent('ServerInfoLoaded', { detail: [launchData.results[0], eventData.results[0]] }));

    Promise.all([
        fetch(launchURL)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network Error');
            }
            return response.json();
        }),
        
        fetch(eventURL)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network Error');
            }
            return response.json();
        })
    ]).then(([launchData, eventData]) => {
        window.dispatchEvent(new CustomEvent('ServerInfoLoaded', { detail: [launchData.results[0], eventData.results[0]] }));
    })
    .catch(e => {
        console.error(`Error: ${e}`);
    });
}

function changeStatus(data) {
    // console.log(data)
    statusIcons = document.querySelectorAll('.StatusIcon');
    statusTexts = document.querySelectorAll('.StatusText');
    // console.log(statusIcons)
    // console.log(statusTexts)
    if (data.online) {
        for (icon of statusIcons) {
            icon.classList.remove('bi-x-circle-fill');
            icon.style.color = 'green';
            icon.classList.add('bi-check-circle-fill');
        }
        for (text of statusTexts) {
            text.innerText = `${data.players.online}/${data.players.max} Players`
        }
    } else {
        for (icon of statusIcons) {
            icon.classList.remove('bi-check-circle-fill')
            icon.style.color = 'darkred';
            icon.classList.add('bi-x-circle-fill');
        }
        for (text of statusTexts) {
            text.innerText = "Offline"
        }
    }
}